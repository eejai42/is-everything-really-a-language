-- ============================================================================
-- DROP AND CREATE TABLES - Clean slate + Normalized schema
-- ============================================================================
-- Generated by rulebook-to-postgres tool
-- Total Tables: 2
-- Total Raw Fields: 23
-- ============================================================================

-- ============================================================================
-- DROP SPECIFIC OBJECTS - Only dropping objects that will be recreated
-- ============================================================================

-- Drop functions (order: first, because views depend on them)
DROP FUNCTION IF EXISTS calc_language_candidates_category_contains_language(TEXT) CASCADE;
DROP FUNCTION IF EXISTS calc_language_candidates_family_feud_mismatch(TEXT) CASCADE;
DROP FUNCTION IF EXISTS calc_language_candidates_family_fued_question(TEXT) CASCADE;
DROP FUNCTION IF EXISTS calc_language_candidates_has_grammar(TEXT) CASCADE;
DROP FUNCTION IF EXISTS calc_language_candidates_is_a_family_feud_top_answer(TEXT) CASCADE;
DROP FUNCTION IF EXISTS calc_language_candidates_relationship_to_concept(TEXT) CASCADE;

-- Drop views (order: second, because they depend on tables)
DROP VIEW IF EXISTS vw_is_everything_a_language CASCADE;
DROP VIEW IF EXISTS vw_language_candidates CASCADE;

-- Drop tables (order: last, after dependent objects are removed)
DROP TABLE IF EXISTS is_everything_a_language CASCADE;
DROP TABLE IF EXISTS language_candidates CASCADE;

-- ============================================================================
-- CREATE TABLES - Normalized data only (no calculated fields)
-- ============================================================================

CREATE TABLE is_everything_a_language (
  is_everything_a_language_id         TEXT                 PRIMARY KEY,
  name                                TEXT                ,
  argument_name                       TEXT                ,
  argument_category                   TEXT                ,
  step_type                           TEXT                ,
  statement                           TEXT                ,
  formalization                       TEXT                ,
  related_candidate_name              TEXT                ,
  related_candidate_id                TEXT                ,
  evidence_from_rulebook              TEXT                ,
  notes                               TEXT                
);

CREATE TABLE language_candidates (
  language_candidate_id               TEXT                 PRIMARY KEY,
  name                                TEXT                ,
  category                            TEXT                ,
  can_be_held                         BOOLEAN             ,
  meaning_is_serialized               BOOLEAN             ,
  requires_parsing                    BOOLEAN             ,
  is_ongology_descriptor              BOOLEAN             ,
  has_syntax                          BOOLEAN             ,
  chosen_language_candidate           BOOLEAN             ,
  sort_order                          INTEGER             ,
  has_identity                        BOOLEAN             ,
  distance_from_concept               INTEGER             
);

