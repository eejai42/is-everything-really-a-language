<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Substrate Report: yaml</title>
    <style>
:root {
    --bg-primary: #ffffff; --bg-secondary: #f8f9fa; --bg-tertiary: #e9ecef;
    --text-primary: #212529; --text-secondary: #6c757d; --border-color: #dee2e6;
    --accent-color: #0d6efd; --success-color: #198754; --warning-color: #ffc107;
    --danger-color: #dc3545; --code-bg: #f6f8fa; --shadow: 0 2px 8px rgba(0,0,0,0.1); --radius: 6px;
}
[data-theme="dark"] {
    --bg-primary: #1a1a2e; --bg-secondary: #16213e; --bg-tertiary: #0f3460;
    --text-primary: #eaeaea; --text-secondary: #b0b0b0; --border-color: #3a3a5c;
    --accent-color: #4dabf7; --success-color: #51cf66; --warning-color: #fcc419;
    --danger-color: #ff6b6b; --code-bg: #0d1117; --shadow: 0 2px 8px rgba(0,0,0,0.3);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-secondary); color: var(--text-primary); line-height: 1.5; min-height: 100vh; }
header { background: var(--bg-primary); border-bottom: 1px solid var(--border-color); padding: 0.75rem 1rem; display: flex; justify-content: space-between; align-items: center; }
.header-left { display: flex; align-items: center; gap: 0.75rem; }
.substrate-icon { font-size: 1.5rem; }
h1 { font-size: 1.1rem; font-weight: 600; }
.header-stats { display: flex; gap: 1rem; font-size: 0.8rem; }
.stat { display: flex; align-items: center; gap: 0.25rem; }
.stat-value { font-weight: 600; }
.score-perfect, .score-good { color: var(--success-color); }
.score-warning { color: var(--warning-color); }
.score-danger { color: var(--danger-color); }
#theme-toggle { background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 50%; width: 28px; height: 28px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; }
#theme-toggle:hover { background: var(--accent-color); color: white; }
#theme-toggle .moon { display: none; }
[data-theme="dark"] #theme-toggle .sun { display: none; }
[data-theme="dark"] #theme-toggle .moon { display: inline; }
.tabs { display: flex; background: var(--bg-primary); border-bottom: 1px solid var(--border-color); overflow-x: auto; padding: 0 0.5rem; }
.tab { background: none; border: none; padding: 0.5rem 1rem; cursor: pointer; font-size: 0.8rem; color: var(--text-secondary); border-bottom: 2px solid transparent; white-space: nowrap; }
.tab:hover { color: var(--text-primary); }
.tab.active { color: var(--accent-color); border-bottom-color: var(--accent-color); font-weight: 500; }
main { padding: 1rem; }
.tab-content { display: none; }
.tab-content.active { display: block; animation: fadeIn 0.2s ease; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
.card { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: var(--radius); padding: 1rem; margin-bottom: 1rem; box-shadow: var(--shadow); }
.card h2 { font-size: 0.9rem; font-weight: 600; margin-bottom: 0.75rem; }
.card h3 { font-size: 0.85rem; font-weight: 500; margin: 1rem 0 0.5rem 0; color: var(--text-secondary); }
pre { background: var(--code-bg); border: 1px solid var(--border-color); border-radius: var(--radius); padding: 0.75rem; overflow-x: auto; font-family: 'SF Mono', Monaco, monospace; font-size: 0.75rem; line-height: 1.4; max-height: 500px; overflow-y: auto; }
.code-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
.code-info { font-size: 0.75rem; color: var(--text-secondary); }
.copy-btn { background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 4px; padding: 0.25rem 0.5rem; font-size: 0.7rem; cursor: pointer; }
.copy-btn:hover { background: var(--accent-color); color: white; }
.markdown-content { line-height: 1.6; }
.markdown-content p { margin-bottom: 0.75rem; }
.markdown-content ul, .markdown-content ol { margin-left: 1.5rem; margin-bottom: 0.75rem; }
.markdown-content li { margin-bottom: 0.25rem; }
.markdown-content code { background: var(--code-bg); padding: 0.125rem 0.375rem; border-radius: 3px; font-size: 0.85em; }
.results-summary { display: flex; gap: 1.5rem; flex-wrap: wrap; margin-bottom: 1rem; }
.result-item { text-align: center; }
.result-value { font-size: 1.5rem; font-weight: 700; }
.result-label { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; }
    </style>
</head>
<body>
    <header>
        <div class="header-left">
            <span class="substrate-icon">üìÑ</span>
            <h1>YAML Execution Substrate</h1>
        </div>
        <div class="header-stats">
            <div class="stat"><span>Score:</span><span class="stat-value score-perfect">100.0%</span></div>
            <div class="stat"><span>184/184 passed</span></div>
        </div>
        <button id="theme-toggle" title="Toggle theme"><span class="sun">‚òÄÔ∏è</span><span class="moon">üåô</span></button>
    </header>
    <nav class="tabs">
        <button class="tab active" data-tab="description">Description</button>
        <button class="tab" data-tab="log">Run Log</button>
        <button class="tab" data-tab="results">Test Results</button>
        <button class="tab" data-tab="schema">Schema Definition</button>
    </nav>
    <main>
        <div id="description" class="tab-content active">
            <div class="card">
                <h2>What This Substrate Does</h2>
                <div class="markdown-content">
                    <p>The YAML substrate provides a human-readable schema definition format that leverages the shared Python calculation engine for formula evaluation.</p>
                    <h3>Orchestration Pattern</h3>
                    <ol>
                        <li><strong>Schema</strong>: <code>schema.yaml</code> defines entities, fields, and their relationships</li>
                        <li><strong>Shared Engine</strong>: Uses <code>python/erb_calc.py</code> for all calculations</li>
                        <li><strong>Execute</strong>: <code>take-test.py</code> loads YAML schema and computes calculated fields</li>
                        <li><strong>Test</strong>: Compares computed values against expected answers</li>
                    </ol>
                </div>
            </div>
            <div class="card">
                <h2>Key Features</h2>
                <ul class="markdown-content">
                    <li><strong>Human-Readable Schema</strong>: YAML format for easy editing and version control</li>
                    <li><strong>Shared Calculation Engine</strong>: Reuses Python substrate's erb_calc.py</li>
                    <li><strong>Schema Validation</strong>: Validates data against YAML type definitions</li>
                    <li><strong>Dependency Tracking</strong>: Fields declare their dependencies explicitly</li>
                </ul>
            </div>
        </div>
        <div id="log" class="tab-content">
            <div class="card">
                <h2>Execution Log</h2>
                <pre>=== YAML Substrate Test Run ===

YAML substrate: Loaded schema with 6 calculated fields
  - category_contains_language: FIND(&quot;language&quot;, LOWER(category)) &gt; 0
  - has_grammar: CAST(has_syntax AS TEXT)
  - relationship_to_concept: IF(distance_from_concept = 1, &quot;IsMirrorOf&quot;, &quot;Is...
  - family_fued_question: &quot;Is &quot; &amp; name &amp; &quot; a language?&quot;
  - is_a_family_feud_top_answer: AND(   category_contains_language,   has_syntax...
  ... and 1 more
  -&gt; language_candidates: 23 records
YAML substrate: Processed 1 entities, 23 total records

</pre>
            </div>
        </div>
        <div id="results" class="tab-content">
            <div class="card">
                <h2>Test Summary</h2>
                <div class="results-summary">
                    <div class="result-item"><div class="result-value score-perfect">100.0%</div><div class="result-label">Score</div></div>
                    <div class="result-item"><div class="result-value score-perfect">184</div><div class="result-label">Passed</div></div>
                    <div class="result-item"><div class="result-value">0</div><div class="result-label">Failed</div></div>
                    <div class="result-item"><div class="result-value">184</div><div class="result-label">Total</div></div>
                </div>
            </div>
        </div>
        <div id="schema" class="tab-content">
            <div class="card">
                <div class="code-header">
                    <h2>schema.yaml</h2>
                    <div><span class="code-info">209 lines</span><button class="copy-btn" onclick="copyCode('schema-code')">Copy</button></div>
                </div>
                <pre id="schema-code"># ERB Schema - Language Candidates Rulebook
# Source: effortless-rulebook/effortless-rulebook.json
# This is a schema-only file (no data) for LLM consumption

entities:
  LanguageCandidate:
    description: &quot;A candidate item to evaluate whether it qualifies as a &#x27;language&#x27;&quot;
    primary_key: language_candidate_id

    raw_fields:
      language_candidate_id:
        type: string
        nullable: false
      name:
        type: string
        nullable: true
      category:
        type: string
        nullable: true
        examples: [&quot;Natural Language&quot;, &quot;Formal Language&quot;, &quot;Physical Object&quot;, &quot;Running Software&quot;]
      can_be_held:
        type: boolean
        nullable: true
        description: &quot;Tangibility predicate - can this be physically held?&quot;
      meaning_is_serialized:
        type: boolean
        nullable: true
        description: &quot;Can meaning be represented in serialized form?&quot;
      requires_parsing:
        type: boolean
        nullable: true
        description: &quot;Does it need parsing to be interpreted?&quot;
      is_ongology_descriptor:
        type: boolean
        nullable: true
        description: &quot;Does it function as an ontology/descriptor system?&quot;
      has_syntax:
        type: boolean
        nullable: true
        description: &quot;Does it have explicit grammar rules?&quot;
      chosen_language_candidate:
        type: boolean
        nullable: true
        description: &quot;Manually marked as a &#x27;true&#x27; language candidate&quot;
      sort_order:
        type: integer
        nullable: true
      has_identity:
        type: boolean
        nullable: true
        description: &quot;Does it have persistent identity?&quot;
      distance_from_concept:
        type: integer
        nullable: true
        values: [1, 2]
        description: &quot;1=Mirror (is the thing), 2=Description (describes the thing)&quot;

    calculated_fields:
      # Level 1: Simple calculations on raw fields only
      category_contains_language:
        type: boolean
        depends_on: [category]
        formula: &#x27;FIND(&quot;language&quot;, LOWER(category)) &gt; 0&#x27;
        description: &quot;Does the category string contain &#x27;language&#x27;?&quot;

      has_grammar:
        type: string
        depends_on: [has_syntax]
        formula: &quot;CAST(has_syntax AS TEXT)&quot;
        description: &quot;String representation of has_syntax&quot;

      relationship_to_concept:
        type: string
        depends_on: [distance_from_concept]
        formula: &#x27;IF(distance_from_concept = 1, &quot;IsMirrorOf&quot;, &quot;IsDescriptionOf&quot;)&#x27;
        description: &quot;Semantic relationship to the language concept&quot;

      family_fued_question:
        type: string
        depends_on: [name]
        formula: &#x27;&quot;Is &quot; &amp; name &amp; &quot; a language?&quot;&#x27;
        description: &quot;The Family Feud style question&quot;

      # Level 2: Depends on Level 1 calculations
      is_a_family_feud_top_answer:
        type: boolean
        depends_on:
          - category_contains_language  # Level 1 calc
          - has_syntax                  # raw
          - can_be_held                 # raw
          - meaning_is_serialized       # raw
          - requires_parsing            # raw
          - is_ongology_descriptor      # raw
          - has_identity                # raw
          - distance_from_concept       # raw
        formula: |
          AND(
            category_contains_language,
            has_syntax,
            NOT(can_be_held),
            meaning_is_serialized,
            requires_parsing,
            is_ongology_descriptor,
            NOT(has_identity),
            distance_from_concept = 2
          )
        description: &quot;Would this be a &#x27;top answer&#x27; on Family Feud for &#x27;Is X a language?&#x27;&quot;

      # Level 3: Depends on Level 2 calculations
      family_feud_mismatch:
        type: string
        depends_on:
          - is_a_family_feud_top_answer  # Level 2 calc
          - chosen_language_candidate    # raw
          - name                         # raw
        formula: |
          IF(is_a_family_feud_top_answer != chosen_language_candidate,
            name &amp; &quot; &quot; &amp;
            IF(is_a_family_feud_top_answer, &quot;Is&quot;, &quot;Isn&#x27;t&quot;) &amp;
            &quot; a Family Feud Language, but &quot; &amp;
            IF(chosen_language_candidate, &quot;Is&quot;, &quot;Is Not&quot;) &amp;
            &quot; marked as a &#x27;Language Candidate.&#x27;&quot;,
            NULL
          )
        description: &quot;Reports mismatches between computed and manual classification&quot;

  IsEverythingALanguage:
    description: &quot;Argument steps in the philosophical debate about language definition&quot;
    primary_key: is_everything_a_language_id

    raw_fields:
      is_everything_a_language_id:
        type: string
        nullable: false
      name:
        type: string
        nullable: true
        description: &quot;Identifier like NEIAL-001&quot;
      argument_name:
        type: string
        nullable: true
        values: [&quot;LanguageCanBeFormalized&quot;, &quot;NotEverythingIsALanguage&quot;]
      argument_category:
        type: string
        nullable: true
        values: [&quot;Definition&quot;, &quot;Premise&quot;, &quot;Conclusion&quot;, &quot;Example&quot;, &quot;Observation&quot;, &quot;Refinement&quot;]
      step_type:
        type: string
        nullable: true
        values: [&quot;Motivation&quot;, &quot;PredicateSet&quot;, &quot;Definition&quot;, &quot;Witness&quot;, &quot;Conclusion&quot;,
                 &quot;Entailment&quot;, &quot;Counterexample&quot;, &quot;NonLanguageExample&quot;, &quot;FuzzyBoundary&quot;, &quot;Refinement&quot;]
      statement:
        type: string
        nullable: true
        description: &quot;Natural language argument text&quot;
      formalization:
        type: string
        nullable: true
        description: &quot;Formal logic notation&quot;
      related_candidate_name:
        type: string
        nullable: true
      related_candidate_id:
        type: string
        nullable: true
        foreign_key: LanguageCandidate.language_candidate_id
      evidence_from_rulebook:
        type: string
        nullable: true
        description: &quot;Predicate values supporting the candidate&quot;
      notes:
        type: string
        nullable: true

    calculated_fields: {}  # No calculations on this entity

# DAG Execution Order (topological sort)
calculation_dag:
  level_0:
    - all raw fields from both entities
  level_1:
    - LanguageCandidate.category_contains_language
    - LanguageCandidate.has_grammar
    - LanguageCandidate.relationship_to_concept
    - LanguageCandidate.family_fued_question
  level_2:
    - LanguageCandidate.is_a_family_feud_top_answer
  level_3:
    - LanguageCandidate.family_feud_mismatch

# Core Language Definition (from the rulebook)
language_definition:
  formula: |
    Language(x) := HasSyntax(x)
                   AND RequiresParsing(x)
                   AND Meaning_Is_Serialized(x)
                   AND IsOngologyDescriptor(x)
  predicates:
    core:
      - has_syntax
      - requires_parsing
      - meaning_is_serialized
      - is_ongology_descriptor
    auxiliary:
      - can_be_held
      - has_identity
      - distance_from_concept
      - category
</pre>
            </div>
        </div>
    </main>
    <script>
const themeToggle = document.getElementById('theme-toggle');
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
function getInitialTheme() { try { if (window.parent && window.parent.document.documentElement.dataset.theme) return window.parent.document.documentElement.dataset.theme; } catch (e) {} return prefersDark ? 'dark' : 'light'; }
document.documentElement.dataset.theme = getInitialTheme();
themeToggle.addEventListener('click', () => { document.documentElement.dataset.theme = document.documentElement.dataset.theme === 'dark' ? 'light' : 'dark'; });
window.addEventListener('message', (event) => { if (event.data.type === 'theme-change') document.documentElement.dataset.theme = event.data.theme; });
document.querySelectorAll('.tab').forEach(tab => { tab.addEventListener('click', () => { document.querySelectorAll('.tab').forEach(t => t.classList.remove('active')); document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active')); tab.classList.add('active'); document.getElementById(tab.dataset.tab).classList.add('active'); }); });
function copyCode(elementId) { navigator.clipboard.writeText(document.getElementById(elementId).textContent).then(() => { event.target.textContent = 'Copied!'; setTimeout(() => event.target.textContent = 'Copy', 2000); }); }
    </script>
</body>
</html>